From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Jake Bailey <5341706+jakebailey@users.noreply.github.com>
Date: Sat, 15 Oct 2022 16:45:30 -0700
Subject: [PATCH] Move big test file out of namespace folder

---
 src/testRunner/_namespaces/Harness.ts |   3 +-
 src/testRunner/_namespaces/tests.ts   | 187 --------------------------
 src/testRunner/runner.ts              |   4 +-
 src/testRunner/tests.ts               | 187 ++++++++++++++++++++++++++
 4 files changed, 189 insertions(+), 192 deletions(-)
 delete mode 100644 src/testRunner/_namespaces/tests.ts
 create mode 100644 src/testRunner/tests.ts

diff --git a/src/testRunner/_namespaces/Harness.ts b/src/testRunner/_namespaces/Harness.ts
index 602d83e412..a5b5cb5ab3 100644
--- a/src/testRunner/_namespaces/Harness.ts
+++ b/src/testRunner/_namespaces/Harness.ts
@@ -12,8 +12,7 @@ export * from "../externalCompileRunner";
 export * from "../test262Runner";
 export * from "../runner";
 
-// If running as emitted CJS, don't start executing the tests here; instead start in runner.ts.
 // If running bundled, we want this to be here so that esbuild places the tests after runner.ts.
 if (!__filename.endsWith("Harness.js")) {
-    require("./tests");
+    require("../tests");
 }
diff --git a/src/testRunner/_namespaces/tests.ts b/src/testRunner/_namespaces/tests.ts
deleted file mode 100644
index 0c8cba942b..0000000000
--- a/src/testRunner/_namespaces/tests.ts
+++ /dev/null
@@ -1,187 +0,0 @@
-// Tests; see tsconfig.json list
-
-import "../unittests/asserts";
-import "../unittests/base64";
-import "../unittests/builder";
-import "../unittests/comments";
-import "../unittests/compilerCore";
-import "../unittests/convertToBase64";
-import "../unittests/customTransforms";
-import "../unittests/factory";
-import "../unittests/incrementalParser";
-import "../unittests/jsDocParsing";
-import "../unittests/jsonParserRecovery";
-import "../unittests/moduleResolution";
-import "../unittests/parsePseudoBigInt";
-import "../unittests/paths";
-import "../unittests/printer";
-import "../unittests/programApi";
-import "../unittests/publicApi";
-import "../unittests/reuseProgramStructure";
-import "../unittests/semver";
-import "../unittests/transform";
-import "../unittests/config/commandLineParsing";
-import "../unittests/config/configurationExtension";
-import "../unittests/config/convertCompilerOptionsFromJson";
-import "../unittests/config/convertTypeAcquisitionFromJson";
-import "../unittests/config/initializeTSConfig";
-import "../unittests/config/matchFiles";
-import "../unittests/config/projectReferences";
-import "../unittests/config/showConfig";
-import "../unittests/config/tsconfigParsing";
-import "../unittests/config/tsconfigParsingWatchOptions";
-import "../unittests/evaluation/arraySpread";
-import "../unittests/evaluation/asyncArrow";
-import "../unittests/evaluation/asyncGenerator";
-import "../unittests/evaluation/awaiter";
-import "../unittests/evaluation/destructuring";
-import "../unittests/evaluation/externalModules";
-import "../unittests/evaluation/forAwaitOf";
-import "../unittests/evaluation/forOf";
-import "../unittests/evaluation/optionalCall";
-import "../unittests/evaluation/objectRest";
-import "../unittests/evaluation/superInStaticInitializer";
-import "../unittests/evaluation/templateLiteral";
-import "../unittests/evaluation/updateExpressionInModule";
-import "../unittests/services/cancellableLanguageServiceOperations";
-import "../unittests/services/colorization";
-import "../unittests/services/convertToAsyncFunction";
-import "../unittests/services/documentRegistry";
-import "../unittests/services/extract/constants";
-import "../unittests/services/extract/functions";
-import "../unittests/services/extract/symbolWalker";
-import "../unittests/services/extract/ranges";
-import "../unittests/services/hostNewLineSupport";
-import "../unittests/services/languageService";
-import "../unittests/services/organizeImports";
-import "../unittests/services/patternMatcher";
-import "../unittests/services/preProcessFile";
-import "../unittests/services/textChanges";
-import "../unittests/services/transpile";
-import "../unittests/tsbuild/amdModulesWithOut";
-import "../unittests/tsbuild/clean";
-import "../unittests/tsbuild/configFileErrors";
-import "../unittests/tsbuild/configFileExtends";
-import "../unittests/tsbuild/containerOnlyReferenced";
-import "../unittests/tsbuild/declarationEmit";
-import "../unittests/tsbuild/demo";
-import "../unittests/tsbuild/emitDeclarationOnly";
-import "../unittests/tsbuild/emptyFiles";
-import "../unittests/tsbuild/exitCodeOnBogusFile";
-import "../unittests/tsbuild/graphOrdering";
-import "../unittests/tsbuild/inferredTypeFromTransitiveModule";
-import "../unittests/tsbuild/javascriptProjectEmit";
-import "../unittests/tsbuild/lateBoundSymbol";
-import "../unittests/tsbuild/moduleResolution";
-import "../unittests/tsbuild/moduleSpecifiers";
-import "../unittests/tsbuild/noEmit";
-import "../unittests/tsbuild/noEmitOnError";
-import "../unittests/tsbuild/outFile";
-import "../unittests/tsbuild/outputPaths";
-import "../unittests/tsbuild/publicApi";
-import "../unittests/tsbuild/referencesWithRootDirInParent";
-import "../unittests/tsbuild/resolveJsonModule";
-import "../unittests/tsbuild/sample";
-import "../unittests/tsbuild/transitiveReferences";
-import "../unittests/tsbuildWatch/configFileErrors";
-import "../unittests/tsbuildWatch/demo";
-import "../unittests/tsbuildWatch/moduleResolution";
-import "../unittests/tsbuildWatch/noEmit";
-import "../unittests/tsbuildWatch/noEmitOnError";
-import "../unittests/tsbuildWatch/programUpdates";
-import "../unittests/tsbuildWatch/projectsBuilding";
-import "../unittests/tsbuildWatch/publicApi";
-import "../unittests/tsbuildWatch/reexport";
-import "../unittests/tsbuildWatch/watchEnvironment";
-import "../unittests/tsc/cancellationToken";
-import "../unittests/tsc/composite";
-import "../unittests/tsc/declarationEmit";
-import "../unittests/tsc/forceConsistentCasingInFileNames";
-import "../unittests/tsc/incremental";
-import "../unittests/tsc/listFilesOnly";
-import "../unittests/tsc/projectReferences";
-import "../unittests/tsc/redirect";
-import "../unittests/tsc/runWithoutArgs";
-import "../unittests/tscWatch/consoleClearing";
-import "../unittests/tscWatch/emit";
-import "../unittests/tscWatch/nodeNextWatch";
-import "../unittests/tscWatch/emitAndErrorUpdates";
-import "../unittests/tscWatch/forceConsistentCasingInFileNames";
-import "../unittests/tscWatch/incremental";
-import "../unittests/tscWatch/moduleResolution";
-import "../unittests/tscWatch/programUpdates";
-import "../unittests/tscWatch/projectsWithReferences";
-import "../unittests/tscWatch/resolutionCache";
-import "../unittests/tscWatch/sourceOfProjectReferenceRedirect";
-import "../unittests/tscWatch/watchApi";
-import "../unittests/tscWatch/watchEnvironment";
-import "../unittests/tsserver/applyChangesToOpenFiles";
-import "../unittests/tsserver/autoImportProvider";
-import "../unittests/tsserver/auxiliaryProject";
-import "../unittests/tsserver/cachingFileSystemInformation";
-import "../unittests/tsserver/cancellationToken";
-import "../unittests/tsserver/compileOnSave";
-import "../unittests/tsserver/completions";
-import "../unittests/tsserver/completionsIncomplete";
-import "../unittests/tsserver/configFileSearch";
-import "../unittests/tsserver/configuredProjects";
-import "../unittests/tsserver/declarationFileMaps";
-import "../unittests/tsserver/documentRegistry";
-import "../unittests/tsserver/duplicatePackages";
-import "../unittests/tsserver/dynamicFiles";
-import "../unittests/tsserver/events/largeFileReferenced";
-import "../unittests/tsserver/events/projectLanguageServiceState";
-import "../unittests/tsserver/events/projectLoading";
-import "../unittests/tsserver/events/projectUpdatedInBackground";
-import "../unittests/tsserver/exportMapCache";
-import "../unittests/tsserver/externalProjects";
-import "../unittests/tsserver/forceConsistentCasingInFileNames";
-import "../unittests/tsserver/formatSettings";
-import "../unittests/tsserver/getApplicableRefactors";
-import "../unittests/tsserver/getEditsForFileRename";
-import "../unittests/tsserver/getExportReferences";
-import "../unittests/tsserver/getFileReferences";
-import "../unittests/tsserver/importHelpers";
-import "../unittests/tsserver/inlayHints";
-import "../unittests/tsserver/inferredProjects";
-import "../unittests/tsserver/jsdocTag";
-import "../unittests/tsserver/languageService";
-import "../unittests/tsserver/maxNodeModuleJsDepth";
-import "../unittests/tsserver/metadataInResponse";
-import "../unittests/tsserver/moduleResolution";
-import "../unittests/tsserver/moduleSpecifierCache";
-import "../unittests/tsserver/navTo";
-import "../unittests/tsserver/occurences";
-import "../unittests/tsserver/openFile";
-import "../unittests/tsserver/packageJsonInfo";
-import "../unittests/tsserver/partialSemanticServer";
-import "../unittests/tsserver/plugins";
-import "../unittests/tsserver/projectErrors";
-import "../unittests/tsserver/projectReferenceCompileOnSave";
-import "../unittests/tsserver/projectReferenceErrors";
-import "../unittests/tsserver/projectReferences";
-import "../unittests/tsserver/projectReferencesSourcemap";
-import "../unittests/tsserver/projects";
-import "../unittests/tsserver/projectsWithReferences";
-import "../unittests/tsserver/refactors";
-import "../unittests/tsserver/reload";
-import "../unittests/tsserver/reloadProjects";
-import "../unittests/tsserver/rename";
-import "../unittests/tsserver/resolutionCache";
-import "../unittests/tsserver/session";
-import "../unittests/tsserver/skipLibCheck";
-import "../unittests/tsserver/smartSelection";
-import "../unittests/tsserver/symlinkCache";
-import "../unittests/tsserver/symLinks";
-import "../unittests/tsserver/syntacticServer";
-import "../unittests/tsserver/syntaxOperations";
-import "../unittests/tsserver/textStorage";
-import "../unittests/tsserver/telemetry";
-import "../unittests/tsserver/typeAquisition";
-import "../unittests/tsserver/typeOnlyImportChains";
-import "../unittests/tsserver/typeReferenceDirectives";
-import "../unittests/tsserver/typingsInstaller";
-import "../unittests/tsserver/versionCache";
-import "../unittests/tsserver/watchEnvironment";
-import "../unittests/tsserver/webServer";
-import "../unittests/debugDeprecation";
diff --git a/src/testRunner/runner.ts b/src/testRunner/runner.ts
index 528a3f6930..20f02a647a 100644
--- a/src/testRunner/runner.ts
+++ b/src/testRunner/runner.ts
@@ -296,11 +296,9 @@ function startTestEnvironment() {
 startTestEnvironment();
 
 // This brings in all of the unittests.
-// NOTE: if emitting CJS, uncomment this, and comment out the one in Harness.ts.
-// import "./_namespaces/tests";
 
 // If running as emitted CJS, we want to start the tests here after startTestEnvironment.
 // If running bundled, we will do this in Harness.ts.
 if (__filename.endsWith("runner.js")) {
-    require("./_namespaces/tests");
+    require("./tests");
 }
diff --git a/src/testRunner/tests.ts b/src/testRunner/tests.ts
new file mode 100644
index 0000000000..944cdc58c3
--- /dev/null
+++ b/src/testRunner/tests.ts
@@ -0,0 +1,187 @@
+// Tests; see tsconfig.json list
+
+import "./unittests/asserts";
+import "./unittests/base64";
+import "./unittests/builder";
+import "./unittests/comments";
+import "./unittests/compilerCore";
+import "./unittests/convertToBase64";
+import "./unittests/customTransforms";
+import "./unittests/factory";
+import "./unittests/incrementalParser";
+import "./unittests/jsDocParsing";
+import "./unittests/jsonParserRecovery";
+import "./unittests/moduleResolution";
+import "./unittests/parsePseudoBigInt";
+import "./unittests/paths";
+import "./unittests/printer";
+import "./unittests/programApi";
+import "./unittests/publicApi";
+import "./unittests/reuseProgramStructure";
+import "./unittests/semver";
+import "./unittests/transform";
+import "./unittests/config/commandLineParsing";
+import "./unittests/config/configurationExtension";
+import "./unittests/config/convertCompilerOptionsFromJson";
+import "./unittests/config/convertTypeAcquisitionFromJson";
+import "./unittests/config/initializeTSConfig";
+import "./unittests/config/matchFiles";
+import "./unittests/config/projectReferences";
+import "./unittests/config/showConfig";
+import "./unittests/config/tsconfigParsing";
+import "./unittests/config/tsconfigParsingWatchOptions";
+import "./unittests/evaluation/arraySpread";
+import "./unittests/evaluation/asyncArrow";
+import "./unittests/evaluation/asyncGenerator";
+import "./unittests/evaluation/awaiter";
+import "./unittests/evaluation/destructuring";
+import "./unittests/evaluation/externalModules";
+import "./unittests/evaluation/forAwaitOf";
+import "./unittests/evaluation/forOf";
+import "./unittests/evaluation/optionalCall";
+import "./unittests/evaluation/objectRest";
+import "./unittests/evaluation/superInStaticInitializer";
+import "./unittests/evaluation/templateLiteral";
+import "./unittests/evaluation/updateExpressionInModule";
+import "./unittests/services/cancellableLanguageServiceOperations";
+import "./unittests/services/colorization";
+import "./unittests/services/convertToAsyncFunction";
+import "./unittests/services/documentRegistry";
+import "./unittests/services/extract/constants";
+import "./unittests/services/extract/functions";
+import "./unittests/services/extract/symbolWalker";
+import "./unittests/services/extract/ranges";
+import "./unittests/services/hostNewLineSupport";
+import "./unittests/services/languageService";
+import "./unittests/services/organizeImports";
+import "./unittests/services/patternMatcher";
+import "./unittests/services/preProcessFile";
+import "./unittests/services/textChanges";
+import "./unittests/services/transpile";
+import "./unittests/tsbuild/amdModulesWithOut";
+import "./unittests/tsbuild/clean";
+import "./unittests/tsbuild/configFileErrors";
+import "./unittests/tsbuild/configFileExtends";
+import "./unittests/tsbuild/containerOnlyReferenced";
+import "./unittests/tsbuild/declarationEmit";
+import "./unittests/tsbuild/demo";
+import "./unittests/tsbuild/emitDeclarationOnly";
+import "./unittests/tsbuild/emptyFiles";
+import "./unittests/tsbuild/exitCodeOnBogusFile";
+import "./unittests/tsbuild/graphOrdering";
+import "./unittests/tsbuild/inferredTypeFromTransitiveModule";
+import "./unittests/tsbuild/javascriptProjectEmit";
+import "./unittests/tsbuild/lateBoundSymbol";
+import "./unittests/tsbuild/moduleResolution";
+import "./unittests/tsbuild/moduleSpecifiers";
+import "./unittests/tsbuild/noEmit";
+import "./unittests/tsbuild/noEmitOnError";
+import "./unittests/tsbuild/outFile";
+import "./unittests/tsbuild/outputPaths";
+import "./unittests/tsbuild/publicApi";
+import "./unittests/tsbuild/referencesWithRootDirInParent";
+import "./unittests/tsbuild/resolveJsonModule";
+import "./unittests/tsbuild/sample";
+import "./unittests/tsbuild/transitiveReferences";
+import "./unittests/tsbuildWatch/configFileErrors";
+import "./unittests/tsbuildWatch/demo";
+import "./unittests/tsbuildWatch/moduleResolution";
+import "./unittests/tsbuildWatch/noEmit";
+import "./unittests/tsbuildWatch/noEmitOnError";
+import "./unittests/tsbuildWatch/programUpdates";
+import "./unittests/tsbuildWatch/projectsBuilding";
+import "./unittests/tsbuildWatch/publicApi";
+import "./unittests/tsbuildWatch/reexport";
+import "./unittests/tsbuildWatch/watchEnvironment";
+import "./unittests/tsc/cancellationToken";
+import "./unittests/tsc/composite";
+import "./unittests/tsc/declarationEmit";
+import "./unittests/tsc/forceConsistentCasingInFileNames";
+import "./unittests/tsc/incremental";
+import "./unittests/tsc/listFilesOnly";
+import "./unittests/tsc/projectReferences";
+import "./unittests/tsc/redirect";
+import "./unittests/tsc/runWithoutArgs";
+import "./unittests/tscWatch/consoleClearing";
+import "./unittests/tscWatch/emit";
+import "./unittests/tscWatch/nodeNextWatch";
+import "./unittests/tscWatch/emitAndErrorUpdates";
+import "./unittests/tscWatch/forceConsistentCasingInFileNames";
+import "./unittests/tscWatch/incremental";
+import "./unittests/tscWatch/moduleResolution";
+import "./unittests/tscWatch/programUpdates";
+import "./unittests/tscWatch/projectsWithReferences";
+import "./unittests/tscWatch/resolutionCache";
+import "./unittests/tscWatch/sourceOfProjectReferenceRedirect";
+import "./unittests/tscWatch/watchApi";
+import "./unittests/tscWatch/watchEnvironment";
+import "./unittests/tsserver/applyChangesToOpenFiles";
+import "./unittests/tsserver/autoImportProvider";
+import "./unittests/tsserver/auxiliaryProject";
+import "./unittests/tsserver/cachingFileSystemInformation";
+import "./unittests/tsserver/cancellationToken";
+import "./unittests/tsserver/compileOnSave";
+import "./unittests/tsserver/completions";
+import "./unittests/tsserver/completionsIncomplete";
+import "./unittests/tsserver/configFileSearch";
+import "./unittests/tsserver/configuredProjects";
+import "./unittests/tsserver/declarationFileMaps";
+import "./unittests/tsserver/documentRegistry";
+import "./unittests/tsserver/duplicatePackages";
+import "./unittests/tsserver/dynamicFiles";
+import "./unittests/tsserver/events/largeFileReferenced";
+import "./unittests/tsserver/events/projectLanguageServiceState";
+import "./unittests/tsserver/events/projectLoading";
+import "./unittests/tsserver/events/projectUpdatedInBackground";
+import "./unittests/tsserver/exportMapCache";
+import "./unittests/tsserver/externalProjects";
+import "./unittests/tsserver/forceConsistentCasingInFileNames";
+import "./unittests/tsserver/formatSettings";
+import "./unittests/tsserver/getApplicableRefactors";
+import "./unittests/tsserver/getEditsForFileRename";
+import "./unittests/tsserver/getExportReferences";
+import "./unittests/tsserver/getFileReferences";
+import "./unittests/tsserver/importHelpers";
+import "./unittests/tsserver/inlayHints";
+import "./unittests/tsserver/inferredProjects";
+import "./unittests/tsserver/jsdocTag";
+import "./unittests/tsserver/languageService";
+import "./unittests/tsserver/maxNodeModuleJsDepth";
+import "./unittests/tsserver/metadataInResponse";
+import "./unittests/tsserver/moduleResolution";
+import "./unittests/tsserver/moduleSpecifierCache";
+import "./unittests/tsserver/navTo";
+import "./unittests/tsserver/occurences";
+import "./unittests/tsserver/openFile";
+import "./unittests/tsserver/packageJsonInfo";
+import "./unittests/tsserver/partialSemanticServer";
+import "./unittests/tsserver/plugins";
+import "./unittests/tsserver/projectErrors";
+import "./unittests/tsserver/projectReferenceCompileOnSave";
+import "./unittests/tsserver/projectReferenceErrors";
+import "./unittests/tsserver/projectReferences";
+import "./unittests/tsserver/projectReferencesSourcemap";
+import "./unittests/tsserver/projects";
+import "./unittests/tsserver/projectsWithReferences";
+import "./unittests/tsserver/refactors";
+import "./unittests/tsserver/reload";
+import "./unittests/tsserver/reloadProjects";
+import "./unittests/tsserver/rename";
+import "./unittests/tsserver/resolutionCache";
+import "./unittests/tsserver/session";
+import "./unittests/tsserver/skipLibCheck";
+import "./unittests/tsserver/smartSelection";
+import "./unittests/tsserver/symlinkCache";
+import "./unittests/tsserver/symLinks";
+import "./unittests/tsserver/syntacticServer";
+import "./unittests/tsserver/syntaxOperations";
+import "./unittests/tsserver/textStorage";
+import "./unittests/tsserver/telemetry";
+import "./unittests/tsserver/typeAquisition";
+import "./unittests/tsserver/typeOnlyImportChains";
+import "./unittests/tsserver/typeReferenceDirectives";
+import "./unittests/tsserver/typingsInstaller";
+import "./unittests/tsserver/versionCache";
+import "./unittests/tsserver/watchEnvironment";
+import "./unittests/tsserver/webServer";
+import "./unittests/debugDeprecation";
-- 
2.38.0

